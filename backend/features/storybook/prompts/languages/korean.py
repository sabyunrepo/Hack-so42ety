"""
Korean Language Configuration
Detailed prompts for Korean story generation using eojeol-based rules
"""

from . import register_language
from .base import BaseLanguageConfig, LanguageMetadata, LevelExample


@register_language("ko")
class KoreanConfig(BaseLanguageConfig):
    """Korean language configuration with eojeol-based rules"""

    @property
    def metadata(self) -> LanguageMetadata:
        return LanguageMetadata(
            code="ko",
            name="Korean",
            native_name="한국어",
            first_person="나/저",
        )

    def get_level_examples(self, level: int) -> LevelExample:
        examples = {
            1: LevelExample(
                title="즐거운 하루",
                stories=[
                    [
                        "나는 강아지를 봤어요.",
                        "멍멍!",
                        "강아지가 커요.",
                        "우리는 뛰었어요.",
                        "재미있어요!",
                    ],
                ],
            ),
            2: LevelExample(
                title="공원에서 놀았어요",
                stories=[
                    [
                        "오늘 친구와 공원에 갔어요.",
                        "그네를 탔어요.",
                        "햇살이 따뜻했어요.",
                        "정말 재미있었어요!",
                        "신나요!",
                    ],
                ],
            ),
            3: LevelExample(
                title="신나는 모험",
                stories=[
                    [
                        "오늘 아침, 집 뒤 숲을 탐험하기로 했어요.",
                        "나무는 크고 새들이 아름다운 노래를 불렀어요.",
                        "숲 속으로 걸어갈수록 더 신기하고 설레었어요.",
                        "이 모험으로 자연에는 놀라운 것들이 가득하다는 걸 알았어요!",
                        "대단해요!",
                    ],
                ],
            ),
        }
        return examples.get(level, examples[1])

    def get_level_prompt(self, level: int) -> str:
        """Return Korean-specific detailed prompts"""
        prompts = {
            1: """
**[난이도: 레벨 1 - 초보 읽기 단계 (3~5세)]**

당신은 한국어 그림책을 작성하는 전문가입니다.

**[목표 난이도]**
- 어절 수: 문장당 3~5 어절
- 문장 구조: 단순 서술문 위주
- 조사 사용: 은/는, 이/가, 을/를 위주

**[어휘 규칙 - 매우 단순함]**
- **기초 어휘만 사용** (유아 일상 어휘)
- 허용 명사: 엄마, 아빠, 강아지, 고양이, 공, 집, 나무, 꽃, 물, 밥, 친구, 하늘, 해, 달
- 허용 동사: 보다, 가다, 오다, 먹다, 자다, 놀다, 뛰다, 웃다, 울다, 앉다, 서다, 걷다
- 허용 형용사: 크다, 작다, 예쁘다, 좋다, 나쁘다, 빠르다, 느리다, 맛있다, 재미있다
- **한자어 금지**: 모험, 탐험, 상상력, 용기, 우정
- **외래어 금지**: 파티, 게임, 로봇

**[문장 구조 - 단순 패턴]**
- 패턴 1: "주어 + 목적어 + 동사" → "나는 밥을 먹어요."
- 패턴 2: "주어 + 형용사" → "강아지가 커요."
- 패턴 3: "감탄문" → "재미있어요!", "좋아요!"
- **접속사 금지**: 그래서, 하지만, 왜냐하면, 그런데, 그리고 (최소한만)
- **높임말 통일**: -요/-어요 체 사용
- 과거형 제한적: -았어요/-었어요 (전체 20% 이하)

**[반복 구조]**
- 같은 단어 5~10회 반복
- 같은 문장 패턴 2~3회 반복
- 예: "강아지가 뛰어요. 나도 뛰어요. 우리가 뛰어요."

**[표현]**
- 의성어: 멍멍, 야옹, 짹짹, 쿵쿵, 펑펑, 뿅뿅
- 의태어: 반짝반짝, 퐁당퐁당, 데굴데굴, 살금살금
- 감탄사: 와!, 우와!, 신나!, 좋아!, 야호!
- 페이지당 1~2개 사용
""",
            2: """
**[난이도: 레벨 2 - 기초 읽기 완성 단계 (5~7세)]**

당신은 한국어 그림책을 작성하는 전문가입니다.

**[목표 난이도]**
- 어절 수: 문장당 5~8 어절
- 문장 구조: 접속사 활용 시작
- 시제: 현재 60%, 과거 40%

**[어휘 규칙]**
- 기초 어휘 + **간단한 한자어 허용**
- 허용 한자어: 공원, 학교, 친구, 가족, 선생님, 동물, 식물, 놀이터
- 감정 어휘 확대: 기쁘다, 슬프다, 신나다, 무섭다, 놀라다, 궁금하다
- 2음절 부사 허용: 빨리, 천천히, 높이, 멀리

**[문장 구조 - 접속사 활용 시작]**
- 접속사 허용: "그리고", "그래서" (제한적 사용)
- "하지만" 제한적: "놀고 싶어요. 하지만 비가 와요." (전체 10% 이하)
- 의문문 허용: "뭐예요?", "어디예요?", "누구예요?" (전체 15% 이하)
- **금지**: "왜냐하면", "만약", "비록"
- 복합 문장 시작: "공원에 가서 놀았어요."

**[반복 구조]**
- 같은 단어 3~5회 반복
- 같은 문장 패턴 1~2회 반복

**[감정 표현]**
- 기본 감정 자유: 기쁘다, 슬프다, 신나다, 무섭다
- 이유 간단히: "재미있어서 좋았어요."

**[표현]**
- 다양한 의성어/의태어 활용
- 페이지당 2~3개 사용
""",
            3: """
**[난이도: 레벨 3 - 심화 읽기 단계 (7~9세)]**

당신은 한국어 그림책을 작성하는 전문가입니다.

**[목표 난이도]**
- 어절 수: 문장당 8~12 어절
- 문장 구조: 복문/종속절 자유롭게 활용
- 모든 시제 자유롭게 사용

**[어휘 규칙]**
- 다양한 한자어 허용: 모험, 탐험, 발견, 경험, 상상
- 추상 개념 일부 허용: 용기, 우정, 노력, 희망, 꿈
- 감정 어휘 확대: 자랑스럽다, 뿌듯하다, 아쉽다, 미안하다, 감사하다, 설레다
- 비유 표현 일부 허용: "마음이 따뜻해졌어요", "하늘을 나는 것 같았어요"

**[문장 구조 - 복문 자유롭게 활용]**
- 모든 접속사 허용: 그리고, 그래서, 하지만, 왜냐하면, 그러면
- 인과 표현: "왜냐하면 ~했기 때문이에요."
- 조건 표현: "만약 ~하면, ~할 거예요."
- 시간 표현: "~할 때, ~했어요.", "~한 후에, ~했어요."
- 복합 문장: "숲에 가서 새들의 노래를 들었는데, 정말 아름다웠어요."

**[이야기 구조]**
- 명확한 문제-해결 구조
- 캐릭터 감정 변화 묘사
- 교훈적 메시지 포함
- 복선과 반전 요소 가능

**[감정과 교육적 요소]**
- 복합 감정 자유: 자랑스러움, 실망, 감사, 용기, 호기심
- 깊이 있는 교훈: 우정의 가치, 용기와 도전, 친절과 배려, 끈기와 노력

**[표현]**
- 의성어/의태어 자연스럽게 배치
- 페이지당 1~2개 사용 (과도하지 않게)
""",
        }
        return prompts.get(level, prompts[1])

    def get_difficulty_metrics(self, level: int) -> dict:
        """Korean-specific metrics based on eojeol"""
        return {
            1: {
                "eojeol_per_sentence": (3, 5),
                "sentence_count": (15, 25),
                "vocab_level": "basic",
            },
            2: {
                "eojeol_per_sentence": (5, 8),
                "sentence_count": (25, 40),
                "vocab_level": "intermediate",
            },
            3: {
                "eojeol_per_sentence": (8, 12),
                "sentence_count": (40, 60),
                "vocab_level": "advanced",
            },
        }.get(level, {})
