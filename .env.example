# ==============================================
# MoriAI Storybook Service - Environment Variables
# ==============================================

# ==================== Application ====================
APP_ENV=development  # development, staging, production
DEBUG=true
LOG_LEVEL=INFO

# ==================== Server Ports ====================
BACKEND_PORT=8000
FRONTEND_PORT=5173

# ==================== Database (PostgreSQL) ====================
POSTGRES_USER=moriai_user
POSTGRES_PASSWORD=moriai_secure_password_change_me
POSTGRES_DB=moriai_db
POSTGRES_HOST=postgres
POSTGRES_PORT=5432

# SQLAlchemy Database URL (자동 생성됨)
DATABASE_URL=postgresql+asyncpg://${POSTGRES_USER}:${POSTGRES_PASSWORD}@${POSTGRES_HOST}:${POSTGRES_PORT}/${POSTGRES_DB}

# ==================== Redis Cache & Event Bus ====================
REDIS_HOST=redis
REDIS_PORT=6379
REDIS_PASSWORD=  # 개발 환경: 비밀번호 없음 (프로덕션에서는 필수!)
REDIS_DB=0

# ==================== JWT Authentication ====================
JWT_SECRET_KEY=your-super-secret-jwt-key-change-this-in-production-min-32-chars
JWT_ALGORITHM=HS256
JWT_ACCESS_TOKEN_EXPIRE_MINUTES=15
JWT_REFRESH_TOKEN_EXPIRE_DAYS=7

# ==================== Frontend enviroment ====================
API_BASE_URL=/api/v1

# PostHog Analytics (optional, production only)
VITE_PUBLIC_POSTHOG_KEY=phc_your_posthog_project_api_key
VITE_PUBLIC_POSTHOG_HOST=https://us.i.posthog.com

# ==================== Google OAuth 2.0 ====================
GOOGLE_OAUTH_CLIENT_ID=your-google-oauth-client-id.apps.googleusercontent.com
GOOGLE_OAUTH_CLIENT_SECRET=your-google-oauth-client-secret
GOOGLE_OAUTH_REDIRECT_URI=http://localhost:8000/auth/google/callback



# ==================== AI Providers ====================
# Story Generation
AI_STORY_PROVIDER=google  # google, openai, custom
GOOGLE_API_KEY=your-google-gemini-api-key
FK_TOLERANCE=10
MAX_BOOKS_PER_USER=3
MAX_PAGES_PER_BOOK=5
MAX_DIALOGUES_PER_PAGE=4
MAX_CHARS_PER_DIALOGUE=85
MAX_TITLE_LENGTH=20

# TTS (Text-to-Speech)
AI_TTS_PROVIDER=elevenlabs  # elevenlabs, custom
ELEVENLABS_API_KEY=your-elevenlabs-api-key
TTS_DEFAULT_VOICE_ID=TxWD6rImY3v4izkm2VL0
TTS_DEFAULT_MODEL_ID=eleven_multilingual_v2
TTS_DEFAULT_LANGUAGE=en
MAX_VOICE_CLONES_PER_USER=1

# Image Generation
AI_IMAGE_PROVIDER=runware  # google, custom, runware
RUNWARE_IMG2IMG_MODEL=google:4@1

# Video Generation
AI_VIDEO_PROVIDER=runware  # kling, custom
RUNWARE_API_KEY=XsdYy6dDj4ucDrS5wqNS24bgXbQSbOpZ
RUNWARE_API_URL=https://api.runware.ai/v1
RUNWARE_VIDEO_MODEL=klingai:6@0
RUNWARE_VIDEO_MODE=std
RUNWARE_VIDEO_DURATION=5
VIDEO_GENERATION_LIMIT=20

# AI retry settings
TASK_STORY_MAX_RETRIES=3
TASK_IMAGE_MAX_RETRIES=2
TASK_VIDEO_MAX_RETRIES=2
TASK_RETRY_DELAY=2.0
TASK_RETRY_EXPONENTIAL_BACKOFF=true

# ==================== Storage ====================
STORAGE_PROVIDER=local  # local, s3
STORAGE_BASE_PATH=/app/data

# AWS S3 (if STORAGE_PROVIDER=s3)
AWS_ACCESS_KEY_ID=your-aws-access-key
AWS_SECRET_ACCESS_KEY=your-aws-secret-key
AWS_S3_BUCKET_NAME=moriai-storybook-bucket
AWS_S3_REGION=ap-northeast-2
AWS_S3_PRESIGNED_URL_EXPIRATION=3600  # 1시간 (초 단위)

# ==================== CORS ====================
CORS_ORIGINS=http://localhost:5173,http://localhost:3000
CORS_ALLOW_CREDENTIALS=true
CORS_ALLOW_METHODS=GET,POST,PUT,DELETE,OPTIONS
CORS_ALLOW_HEADERS=*

# ==================== Cloudflare Tunnel ====================
CLOUDFLARE_TUNNEL_TOKEN=your-cloudflare-tunnel-token

# ==================== Feature Flags ====================
USE_TEMPLATE_MODE=false  # true: 템플릿 사용, false: AI 생성

# ==================== HTTP Client ====================
HTTP_TIMEOUT=60.0
HTTP_READ_TIMEOUT=300.0
HTTP_MAX_CONNECTIONS=10

# ==================== Testing ====================
TEST_DATABASE_URL=postgresql+asyncpg://test_user:test_password@postgres:5432/test_db

# ==================== Rate Limiting ====================
# Enable/disable rate limiting for authentication endpoints
RATE_LIMIT_ENABLED=true
# Time window in seconds for rate limiting (applies to all auth endpoints)
AUTH_RATE_LIMIT_WINDOW_SECONDS=60
# Per-endpoint rate limits (maximum requests per window)
AUTH_LOGIN_RATE_LIMIT=5       # Login: Most restrictive for brute force protection
AUTH_REGISTER_RATE_LIMIT=3    # Register: Prevents automated account creation
AUTH_GOOGLE_RATE_LIMIT=10     # Google OAuth: Higher as OAuth has built-in protections
AUTH_REFRESH_RATE_LIMIT=30    # Token refresh: Higher as it's called frequently
